<!DOCTYPE html>
<html>
  <head>
    <title>Parcel Sandbox</title>
    <meta charset="UTF-8" />
    <!--Plugin CSS file with desired skin-->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/ion-rangeslider/2.3.1/css/ion.rangeSlider.min.css"
    />

    <!--jQuery-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

    <!--Plugin JavaScript file-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/ion-rangeslider/2.3.1/js/ion.rangeSlider.min.js"></script>

    <style>
      #sws-savings-calculator {
        background-color: white;
        border-style: solid;
        border-width: 2px;
        background-clip: border-box;
        border-color: #f1f1f1;
        border-radius: 10px;
        max-width: 1000px;
        max-height: 700px;
        margin: auto;
        margin-top: 10em;
      }

      #sws-savings-calculator * {
        font-family: "Poppins", sans-serif; /* Need to determine font */
        font-weight: 300;
      }

      .sws-block {
        border-style: solid;
        background-clip: border-box;
        border-color: #f1f1f1;
        background-color: white;
      }

      .sws-block-border-all {
        border-width: 2px;
      }

      .sws-block-border-not-top {
        border-width: 0 2px 2px;
        border-radius: 10px 10px 0 0;
      }

      .sws-block-border-not-bottom {
        border-width: 2px 2px 0;
        border-radius: 0 0 10px 10px;
      }

      .sws-ps-content-border-right {
        border-style: solid;
        border-width: 0;
        background-clip: border-box;
        border-color: #f1f1f1;
        border-right-width: 4px;
      }

      .sws-column-group {
        overflow: hidden;
      }

      .sws-ps-col {
        width: 50%;
        float: left;
      }

      .sws-ps-content {
        padding: 16px;
      }

      .sws-ps-highlighted-number {
        color: #8dc63f;
        font-size: 36px;
        margin: 0;
      }

      .sws-ps-rewards {
        text-align: center;
      }

      .sws-ps-title {
        font-size: 22px;
        line-height: 1.2;
        margin: 10px 0;
      }

      .sws-ps-disclaimer {
        margin-top: 25px;
        margin-bottom: 0;
        font-size: 16px;
      }

      .sws-ps-title.sws-ps-purchase-price-title.sws-ps-total-price-title {
        font-size: 42px;
        text-align: right;
      }

      .irs-grid-pol.small,
      .irs-grid-text,
      .irs-max,
      .irs-min,
      .irs-single {
        display: none;
      }

      #sws-price-slider-lender .irs-min,
      #sws-price-slider-lender .irs-max,
      #sws-price-slider-lender .irs-single {
        display: inherit !important;
      }

      .irs--round .irs-handle {
        border: none !important;
        box-shadow: 1px 1px 10px 5px rgba(52, 152, 219, 0.15) !important;
      }

      .irs--round .irs-grid {
        height: 18px !important;
      }

      .irs--round .irs-bar {
        background-color: #8dc63f;
      }

      .irs--round .irs-single {
        background-color: #8dc63f;
      }
    </style>
  </head>

  <body
    style="background-image: url(https://cashprod.wpengine.com/wp-content/uploads/2020/05/iStock-682432578.jpg); background-position: center center; background-repeat: no-repeat; "
  >
    <div id="sws-savings-calculator">
      <!-- Calculate buyer savings -->
      <div
        id="sws-price-slider-buyer"
        class="sws-block sws-block-border-not-top"
      >
        <div class="sws-column-group">
          <div class="sws-ps-col">
            <div class="sws-ps-content sws-ps-content-border-right">
              <div class="sws-ps-price-messages">
                <p class="sws-ps-title sws-ps-purchase-price-title">
                  The Purchase Price Of Your Home “Buying”
                </p>
                <p class="sws-ps-highlighted-number sws-ps-price">$0</p>
              </div>
              <input
                type="text"
                id="js-range-slider-buyer"
                name="my_range"
                value=""
              />
            </div>
          </div>
          <div class="sws-ps-col">
            <div class="sws-ps-content">
              <div class="sws-ps-savings-messages">
                <p class="sws-ps-title sws-ps-savings-title">
                  Your Rewards At Closing
                </p>
                <p class="sws-ps-highlighted-number sws-ps-savings">$0</p>
                <p class="sws-ps-disclaimer">*Based on a 3% buyer commision</p>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Calculate seller savings -->
      <div id="sws-price-slider-seller" class="sws-block sws-block-border-all">
        <div class="sws-column-group">
          <div class="sws-ps-col">
            <div class="sws-ps-content sws-ps-content-border-right">
              <div class="sws-ps-price-messages">
                <p class="sws-ps-title sws-ps-purchase-price-title">
                  The Sales Price of your home “Selling”
                </p>
                <p class="sws-ps-highlighted-number sws-ps-price">$0</p>
              </div>
              <input
                type="text"
                id="js-range-slider-seller"
                name="my_range"
                value=""
              />
            </div>
          </div>
          <div class="sws-ps-col">
            <div class="sws-ps-content">
              <div class="sws-ps-savings-messages">
                <p class="sws-ps-title sws-ps-savings-title">
                  Your Additional Reward At Close
                </p>
                <p class="sws-ps-highlighted-number sws-ps-savings">$0</p>
                <p class="sws-ps-disclaimer">
                  *Based on a 3% listing commission
                </p>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Calculate lender savings -->
      <div id="sws-price-slider-lender" class="sws-block sws-block-border-all">
        <div class="sws-column-group">
          <div class="sws-ps-col">
            <div class="sws-ps-content sws-ps-content-border-right">
              <div class="sws-ps-price-messages">
                <p class="sws-ps-title sws-ps-purchase-price-title">
                  By utilizing a CashAtClose Preferred Lender you’ll receive and
                  additional $1,000 Incentive At Closing
                </p>
                <div style="width: 120px;">
                  <input
                    type="text"
                    id="js-range-slider-lender"
                    name="my_range"
                    value=""
                  />
                </div>
              </div>
            </div>
          </div>
          <div class="sws-ps-col">
            <div class="sws-ps-content">
              <div class="sws-ps-savings-messages">
                <p class="sws-ps-title sws-ps-savings-title">
                  Additional Lender Incentive
                </p>
                <p class="sws-ps-highlighted-number sws-ps-savings">$0</p>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Show total -->
      <div
        id="sws-price-slider-total"
        class="sws-block sws-block-border-not-bottom"
      >
        <div class="sws-ps-content sws-ps-rewards">
          <span
            class="sws-ps-title sws-ps-purchase-price-title sws-ps-total-price-title"
          >
            Your Potential Rewards
          </span>
          <span
            id="sws-ps-total-savings"
            class="sws-ps-highlighted-number sws-ps-savings"
          >
            $0
          </span>
        </div>
      </div>
    </div>
    <script>
      (function($) {
        window.addEventListener("DOMContentLoaded", function() {
          var minHomePrice = 150000;
          var maxHomePrice = 3000000;

          // Savings state
          var savingsObj = {
            buyerSavings: 0,
            sellerSavings: 0,
            lenderSavings: 0,
            calculateTotal: function() {
              return (
                this.buyerSavings + this.sellerSavings + this.lenderSavings
              );
            }
          };

          var calculateBuyerSavings = function(price) {
            var buyerCommision = 0.03;
            var discount = 0.25;
            return Math.floor(price * buyerCommision * discount);
          };

          var calculateSellerSavings = function(price) {
            var discount = 0.01;
            return Math.floor(price * discount);
          };

          var calculateLenderSavings = function(option) {
            var discount = 1000;
            return option === "Yes" ? discount : 0;
          };

          var sliderChangeHandler = function(
            topSelector,
            savingsCalculator,
            savingsKey
          ) {
            return function(data) {
              var price = data.from_value;
              var savings = savingsCalculator(price);

              // Update savings by type
              savingsObj[savingsKey] = savings;

              // Lender savings does not have dynamic input price
              if (savingsKey !== "lenderSavings") {
                $(topSelector + " .sws-ps-price").text(
                  "$" + formatNumber(price)
                );
              }

              $(topSelector + " .sws-ps-savings").text(
                "$" + formatNumber(savings)
              );

              // Display total
              $("#sws-ps-total-savings").text(
                "$" + formatNumber(savingsObj.calculateTotal())
              );
            };
          };

          var examplePriceListFunc = function(minPrice, maxPrice, step) {
            var list = [0]; // Start at zero
            var price = minPrice;

            do {
              list.push(price);
              price += step;
            } while (price < maxPrice);

            list.push(maxPrice); // End with max

            return list;
          };

          // Create example list of prices with min, max, and step
          var examplePrices = examplePriceListFunc(
            minHomePrice,
            maxHomePrice,
            100000
          );

          // Format number with commas
          var formatNumber = function(num) {
            return num.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g, "$1,");
          };

          /** Initialize all IonRangeSliders **/
          var changeHandlerForBuyerSlider = sliderChangeHandler(
            "#sws-price-slider-buyer",
            calculateBuyerSavings,
            "buyerSavings"
          );
          $("#js-range-slider-buyer").ionRangeSlider({
            skin: "round",
            grid: !0,
            values: examplePrices,
            from: 0,
            hide_min_max: true,
            hide_from_to: true,
            block: false, // for manual input switch effect
            onStart: changeHandlerForBuyerSlider,
            onChange: changeHandlerForBuyerSlider
          });

          var changeHandlerForSellerSlider = sliderChangeHandler(
            "#sws-price-slider-seller",
            calculateSellerSavings,
            "sellerSavings"
          );
          $("#js-range-slider-seller").ionRangeSlider({
            skin: "round",
            grid: !0,
            values: examplePrices,
            from: 0,
            hide_min_max: true,
            hide_from_to: true,
            block: false, // for manual input switch effect
            onStart: changeHandlerForSellerSlider,
            onChange: changeHandlerForSellerSlider
          });

          var changeHandlerForLenderSlider = sliderChangeHandler(
            "#sws-price-slider-lender",
            calculateLenderSavings,
            "lenderSavings"
          );
          $("#js-range-slider-lender").ionRangeSlider({
            skin: "round",
            grid: !0,
            values: ["No", "Yes"],
            from: 0,
            block: false, // for manual input switch effect
            onStart: changeHandlerForLenderSlider,
            onChange: changeHandlerForLenderSlider
          });
        });
      })(jQuery);
    </script>
  </body>
</html>
